
% !TEX TS-program = pdflatex
\documentclass[11pt,letterpaper]{article}

% ---------- Packages ----------
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage[a4paper,margin=0.8in]{geometry}
\usepackage{parskip}
\usepackage[dvipsnames]{xcolor}
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=MidnightBlue, urlcolor=MidnightBlue, citecolor=MidnightBlue}
\usepackage{multicol}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{array}
\usepackage[most]{tcolorbox}
\usepackage{pifont}
\usepackage{listings}

% ---------- Listings (code) ----------
\lstdefinestyle{codeblock}{
  basicstyle=\ttfamily\small,
  columns=fullflexible,
  breaklines=true,
  frame=single,
  rulecolor=\color{black!15},
  backgroundcolor=\color{black!2},
  framerule=0.3pt,
  xleftmargin=0pt,
  xrightmargin=0pt,
  aboveskip=6pt,
  belowskip=6pt
}

% Minimal YAML colorizing (safe fallback)
\lstdefinelanguage{YAML}{
  keywords={true,false,null,y,n},
  keywordstyle=\color{RoyalBlue}\bfseries,
  basicstyle=\ttfamily\small,
  sensitive=false,
  comment=[l]{\#},
  morecomment=[l]{\#},
  commentstyle=\color{gray}\ttfamily,
  stringstyle=\color{ForestGreen}\ttfamily,
  morestring=[b]',
  morestring=[b]",
}

% ---------- Colors & Boxes ----------
\definecolor{Hdr}{HTML}{0F3554}
\definecolor{HdrAccent}{HTML}{1F7A8C}
\definecolor{Soft}{HTML}{F6F8FA}

\tcbset{
  sharp corners,
  boxsep=4pt,
  colframe=HdrAccent,
  colback=white,
  left=6pt,right=6pt,top=6pt,bottom=6pt
}

\newtcolorbox{headlinebox}[1][]{colframe=Hdr, colback=Hdr!4, enhanced, borderline={0.8pt}{0pt}{Hdr}, #1}

\newcommand{\cmark}{\textcolor{ForestGreen}{\ding{51}}}
\newcommand{\xmark}{\textcolor{BrickRed}{\ding{55}}}

% ---------- Typography ----------
\setlist[itemize]{itemsep=2pt, topsep=4pt, leftmargin=1.1em}
\setlist[enumerate]{itemsep=2pt, topsep=4pt, leftmargin=1.4em}

% ---------- Document ----------
\begin{document}

% Header
\begin{headlinebox}
{\Large\bfseries GHAS + Dependabot --- Quick Cheatsheet}\hfill {\small v1.0}\\
{\small Shift-left dependency security • Fast triage • Ready-to-copy snippets}
\end{headlinebox}

\vspace{0.4em}

\begin{multicols}{2}
\small

% -------------------- Section: What it does --------------------
\begin{tcolorbox}[title=\bfseries What Dependabot Does]
\begin{itemize}
  \item Scans manifests/lockfiles to flag \textbf{outdated/vulnerable dependencies}.
  \item Auto-opens \textbf{PRs with version bumps}, release notes, and CVE context.
  \item Supports grouping updates and schedules to reduce noise.
\end{itemize}
\end{tcolorbox}

% -------------------- Section: Fast triage --------------------
\begin{tcolorbox}[title=\bfseries Fast Triage Flow (Alerts)]
\begin{enumerate}
  \item \textbf{Open alert} → review severity, affected package/version, suggested fix.
  \item \textbf{Assess blast radius} → repo usage, transitive deps, deployment paths.
  \item \textbf{Choose remediation}: merge PR, pin/override, or temporarily ignore (with rationale + expiry).
  \item \textbf{Verify} → CI passes, regression tests, security checks; monitor post-merge.
\end{enumerate}
\end{tcolorbox}

% -------------------- Section: If you ignore --------------------
\begin{tcolorbox}[title=\bfseries If You Ignore Alerts]
\begin{itemize}
  \item \xmark\ Wider attack surface \quad \xmark\ Compliance drift \quad \xmark\ Target for mass exploits.
  \item Tame noise via \textbf{bundling}, \textbf{PR limits}, and \textbf{ownership rotation}.
\end{itemize}
\end{tcolorbox}

% -------------------- Section: Developer responsibilities --------------------
\begin{tcolorbox}[title=\bfseries Developer Responsibilities]
\begin{itemize}
  \item Read the alert; \textbf{learn the vulnerable pattern} and coordinate with security.
  \item Prefer \textbf{patched versions}; avoid pinning to known-vulnerable releases.
  \item Keep PRs small and monitored; link to tickets if deferred.
\end{itemize}
\end{tcolorbox}

% -------------------- Section: Access & visibility --------------------
\begin{tcolorbox}[title=\bfseries Access \& Visibility]
\begin{itemize}
  \item Security dashboard is visible to readers; use \textbf{RBAC} for least-privilege.
  \item Protect branches with \textbf{required PR checks} and \textbf{GHAS status checks}.
\end{itemize}
\end{tcolorbox}

% -------------------- Section: SDLC placement --------------------
\begin{tcolorbox}[title=\bfseries Where It Fits in the SDLC]
\begin{itemize}
  \item \textbf{Desk/CLI} \(\rightarrow\) \textbf{PR checks} \(\rightarrow\) \textbf{Protected branches} \(\rightarrow\) \textbf{Scheduled scans after deploy}.
  \item Catch newly disclosed CVEs and open remediation PRs even after release.
\end{itemize}
\end{tcolorbox}

% -------------------- Section: SLAs table --------------------
\begin{tcolorbox}[title=\bfseries Suggested SLAs (example)]
\renewcommand{\arraystretch}{1.15}
\begin{tabularx}{\linewidth}{@{}>{\bfseries}l c X@{}}
\toprule
Severity & Target & Notes \\
\midrule
Critical & 24--48h & Hotfix, monitor after merge \\
High     & 3--5d   & Expedite into next release \\
Medium   & Next release & Bundle where possible \\
Low      & Backlog & Review quarterly \\
\bottomrule
\end{tabularx}
\end{tcolorbox}

% -------------------- Section: SECURITY.md snippet --------------------
\begin{tcolorbox}[title=\bfseries SECURITY.md (Starter)]
\begin{lstlisting}[style=codeblock]
# Security Policy

## Supported Versions
We patch the latest minor of the current major for active services.

## Reporting a Vulnerability
Email security@yourorg.example or open a private security advisory in GitHub.

## Handling
Triage within 1 business day; fix targets by severity:
- Critical: 24--48h
- High: 3--5 days
- Medium/Low: next scheduled release

## Dependencies
We use GitHub Dependabot for alerts and PRs.
\end{lstlisting}
\end{tcolorbox}

% -------------------- Section: dependabot.yml --------------------
\begin{tcolorbox}[title=\bfseries \texttt{.github/dependabot.yml} (Copy-Ready)]
\begin{lstlisting}[style=codeblock,language=YAML]
version: 2
updates:
  - package-ecosystem: "pip"
    directory: "/"
    schedule: { interval: "daily" }
    allow: [ { dependency-type: "direct" } ]
    ignore:
      - dependency-name: "Django"
        versions: ["<4.2"]    # tighten to your policy
    open-pull-requests-limit: 5

  - package-ecosystem: "npm"
    directory: "/"
    schedule: { interval: "weekly" }

  - package-ecosystem: "maven"
    directory: "/"
    schedule: { interval: "weekly" }
\end{lstlisting}
\end{tcolorbox}

% -------------------- Section: PR commands --------------------
\begin{tcolorbox}[title=\bfseries Handy \texttt{@dependabot} PR Commands]
\begin{itemize}
  \item \texttt{@dependabot rebase} \quad \texttt{recreate} \quad \texttt{merge}
  \item \texttt{close} \quad \texttt{squash and merge} \quad \texttt{rebase and merge}
  \item \texttt{check} \quad \texttt{re-run checks}
\end{itemize}
\end{tcolorbox}

\end{multicols}

\vfill
\begin{center}
{\footnotesize This cheatsheet is a starting point; adapt schedules, SLAs, and policies to your org's risk appetite.}
\end{center}

\end{document}
