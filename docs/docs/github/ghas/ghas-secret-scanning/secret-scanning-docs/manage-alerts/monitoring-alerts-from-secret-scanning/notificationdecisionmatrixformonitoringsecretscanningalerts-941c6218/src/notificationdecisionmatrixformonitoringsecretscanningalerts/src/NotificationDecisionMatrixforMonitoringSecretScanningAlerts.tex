\documentclass{article}

\usepackage[margin=1in]{geometry}
\usepackage{array}
\usepackage{booktabs}
\usepackage{caption}

\begin{document}

\title{Notification Decision Matrix for Monitoring Secret Scanning Alerts}
\author{}
\date{}
\maketitle

This document summarizes \emph{who} is notified, and \emph{under what conditions}, when GitHub
secret scanning generates alerts. It distinguishes between notifications from
incremental scans (new secrets as they are committed) and historical scans
(retrospective scans of existing content).

\section*{Decision Matrix by Role and Event}

\begin{table}[htbp]
  \centering
  \small
  \captionsetup{justification=raggedright,singlelinecheck=false}
  \caption{Notification decision matrix for secret scanning alerts}
  \label{tab:decision-matrix}
  \begin{tabular}{
      >{\raggedright\arraybackslash}p{0.22\textwidth}
      >{\raggedright\arraybackslash}p{0.23\textwidth}
      >{\raggedright\arraybackslash}p{0.23\textwidth}
      >{\raggedright\arraybackslash}p{0.23\textwidth}
    }
    \toprule
    \textbf{Role} &
    \textbf{Incremental scan: new secret detected} &
    \textbf{Historical scan completed (secrets may or may not be found)} &
    \textbf{Historical scan detects at least one secret} \\
    \midrule
    Repository administrator &
      Notified according to their notification preferences when a new secret is detected in the repository. &
      No notification when a historical scan completes with \emph{no} secrets detected. &
      Notified when a historical scan detects one or more secrets, subject to notification preferences. \\[0.75em]

    Security manager &
      Notified according to notification preferences when a new secret is detected. &
      Notified whenever a historical scan completes for the organization or enterprise, even if no secrets are found. &
      Notified when a historical scan detects secrets, subject to notification preferences (in addition to the ``scan completed'' notification). \\[0.75em]

    User with custom role (read/write access to the repository) &
      Notified according to notification preferences when a new secret is detected. &
      Not notified solely for completion events with no secrets (unless they also hold another role such as security manager). &
      Notified when a historical scan detects secrets in repositories where their custom role grants access, subject to notification preferences. \\[0.75em]

    Organization owner (who is an administrator of the affected repository) &
      Notified according to notification preferences when a new secret is detected in a repository they administer. &
      Notified whenever a historical scan completes for the organization, even if no secrets are found. &
      No additional detection--specific notification is described beyond the ``scan completed'' notification. \\[0.75em]

    Enterprise owner (who is an administrator of the affected repository) &
      Notified according to notification preferences when a new secret is detected in a repository they administer. &
      Notified whenever a historical scan completes for the enterprise, even if no secrets are found. &
      No additional detection--specific notification is described beyond the ``scan completed'' notification. \\[0.75em]

    Commit author (for the commit that introduced the secret) &
      Always notified when they accidentally commit a secret, \emph{regardless} of their notification preferences. &
      Not notified when a historical scan completes. &
      Not notified when a historical scan detects secrets. \\[0.5em]
    \bottomrule
  \end{tabular}
\end{table}

\section*{Email Delivery Conditions for Preference--Based Notifications}

For all cases in Table~\ref{tab:decision-matrix} that state ``notified according to notification preferences,''
an email notification is sent only when \emph{all} of the following are true:

\begin{itemize}
  \item The user is \textbf{watching} the repository.
  \item For that repository, the user has enabled either:
    \begin{itemize}
      \item ``All activity'', or
      \item A custom configuration that includes ``Security alerts''.
    \end{itemize}
  \item In the personal notification settings, under ``Subscriptions'' and then ``Watching'',
        the user has selected \textbf{Email} as a notification channel.
\end{itemize}

\paragraph{Assignment notifications.}
In addition to the matrix above, \emph{any} user who can be assigned to a secret scanning alert
will receive a notification when an alert is assigned to them,
independent of whether they are watching the repository.
The exact delivery channel (email, web, mobile, and so on) follows their general
GitHub notification settings.

\paragraph{Auditing.}
Actions taken on secret scanning alerts (including resolution and assignment)
can be audited using GitHub's security auditing features, but this auditing
does not change the notification behaviour summarized in the decision matrix.

\end{document}

