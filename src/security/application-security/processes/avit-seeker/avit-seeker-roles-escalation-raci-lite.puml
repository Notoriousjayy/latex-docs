@startuml
' =====================================================================
' AVIT ↔ Seeker Closure — Roles & Escalation (RACI-lite)
' Audience: AppSec leadership, analysts, Seeker SMEs, developers
' Purpose: Clarify ownership and when to escalate.
' =====================================================================

title AVIT ↔ Seeker Closure SOP — Roles, Ownership, Escalation

skinparam backgroundColor #FFFFFF
skinparam shadowing false
skinparam roundcorner 12
skinparam linetype ortho
skinparam ArrowColor #444444
skinparam DefaultTextAlignment left
skinparam NoteBackgroundColor #FFFBE6
skinparam NoteBorderColor #C7B96B
skinparam LegendBackgroundColor #FFFFFF
skinparam LegendBorderColor #B0B0B0

left to right direction

rectangle "Roles" {
  actor "AppSec Analyst\n(Ticket Owner)" as Analyst
  actor "Developer /\nRepo Owner" as Dev
  actor "Seeker Admin / SME" as SME
  actor "Reviewer /\nAudit Consumer" as Reviewer
}

rectangle "Core Activities" {
  rectangle "A1\nValidate finding\nin Seeker" as A1
  rectangle "A2\nCapture evidence\n(minimum audit trail)" as A2
  rectangle "A3\nClose ticket with\nstandard justification" as A3
  rectangle "A4\nRemediate in code\n(if applicable)" as A4
  rectangle "A5\nResolve ambiguity\n(project/workflow/access)" as A5
}

Analyst --> A1 : Responsible
Analyst --> A2 : Responsible
Analyst --> A3 : Responsible

Dev --> A4 : Responsible

SME --> A5 : Responsible

Reviewer --> A2 : Consumes evidence
Reviewer --> A3 : Verifies closure rationale

A1 --> SME : Escalate when:\n- wrong project/module\n- unclear workflow state\n- access limits\n- scope mismatch
A3 --> Dev : Notify when:\nclosure requires remediation\n(or status is not FP/resolved)

legend bottom
  R = Responsible (does the work)
  C = Consulted (helps resolve issues)
  V = Verifies/Consumes (audit/review)
  Escalate when ambiguity exists; do not close.
endlegend

note right of A5
Examples of ambiguity:
- Finding exists but status is not interpretable
- Finding ID maps to multiple items
- Seeker project/module conflicts with ticket
end note

@enduml
