@startuml
title Access Control Model: Roles, Permissions, Resources (RBAC + Policy)

skinparam shadowing false
skinparam monochrome true
skinparam classAttributeIconSize 0
skinparam defaultFontName Helvetica
skinparam defaultFontSize 12

class Subject {
  +userId
  +roles[]
  +attributes
}

class Resource {
  +resourceId
  +ownerId
  +type
  +attributes
}

class Action {
  +verb
  +endpoint
}

class Permission {
  +resourceType
  +action
  +constraints
}

class Role {
  +name
}

class PolicyEngine {
  +evaluate(subject, action, resource)
  +decision: allow|deny
}

Subject "1" -- "0..*" Role : has
Role "1" -- "0..*" Permission : grants
Action .. Permission : matches
Resource .. Permission : targets
PolicyEngine ..> Subject
PolicyEngine ..> Action
PolicyEngine ..> Resource

note right of PolicyEngine
Key message:
Decision is computed
from (subject, action,
resource) plus constraints
(ownership, attributes).
end note
@enduml
