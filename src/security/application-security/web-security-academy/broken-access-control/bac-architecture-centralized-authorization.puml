@startuml
title Broken Access Control: Centralized Authorization (Component View)

skinparam shadowing false
skinparam monochrome true
skinparam componentStyle rectangle
skinparam defaultFontName Helvetica
skinparam defaultFontSize 12

actor "User\n(Browser/Mobile)" as User
actor "Admin" as Admin
actor "Attacker\n(unauthorized)" as Attacker

rectangle "Internet" {
  User --> "API Gateway / Edge" as Edge
  Admin --> Edge
  Attacker --> Edge
}

rectangle "Application Trust Boundary" {
  component "AuthN\n(Session/JWT)" as AuthN
  component "AuthZ\n(Policy/Middleware)" as AuthZ
  component "Resource Service\n(Orders/Accounts/etc.)" as Svc
  database "App DB\n(Resource data)" as DB
}

Edge --> AuthN : validate identity
AuthN --> AuthZ : subject (user, roles)
Edge --> AuthZ : request (action, resource-id)
AuthZ --> Svc : allow/deny + constraints
Svc --> DB : query with\nownership filter
Svc --> Edge : response

note right of AuthZ
Key message:
Authorize every request
server-side and
deny by default.
end note

legend right
|= Symbol |= Meaning |
| Actor | External party |
| Component | App subsystem |
| DB | Protected data |
endlegend
@enduml
