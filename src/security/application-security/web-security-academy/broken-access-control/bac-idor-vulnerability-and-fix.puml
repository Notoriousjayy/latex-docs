@startuml
title IDOR (Horizontal Escalation): Vulnerable Path vs Secure Fix

skinparam shadowing false
skinparam monochrome true
skinparam defaultFontName Helvetica
skinparam defaultFontSize 12

partition "Vulnerable (Anti-Pattern)" {
  start
  :Client sends resource-id\n(e.g., /orders/10002);
  :Server loads resource by id;
  :No ownership check;
  :Return sensitive data;
  stop
}

partition "Secure (Positive Pattern)" {
  start
  :Client sends resource-id;
  :Server identifies current user;
  :Load resource by id;
  if (owner == current user\nOR policy grants?) then (allow)
    :Return data;
  else (deny)
    :Return 403;
  endif
  stop
}

legend right
Key message: ownership/policy check must be server-side.
endlegend
@enduml
