@startuml
title Broken Access Control: Request Evaluation Pipeline (Flow View)

skinparam shadowing false
skinparam monochrome true
skinparam defaultFontName Helvetica
skinparam defaultFontSize 12

start
:Receive request\n(action, resource-id);
:Authenticate\n(session/JWT);
if (Authenticated?) then (yes)
  :Compute subject\n(user, roles, attrs);
  :Load target resource\n(by id);
  if (Ownership / Policy grants?) then (allow)
    :Perform action;
    :Return 2xx;
  else (deny)
    :Return 403;
  endif
else (no)
  :Return 401;
endif
stop

legend right
Start/Stop = visible endpoints
Diamond = decision point
endlegend
@enduml
