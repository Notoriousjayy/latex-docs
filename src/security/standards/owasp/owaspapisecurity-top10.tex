\documentclass[11pt,a4paper]{article}

% --- Page & typography ---
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[final]{microtype}
\usepackage{parskip}            % nicer paragraph spacing
\emergencystretch=2em
\raggedbottom

% --- Color & links ---
\usepackage[dvipsnames]{xcolor}
\definecolor{Accent}{HTML}{003366}      % Midnight-ish blue
\definecolor{SoftBg}{HTML}{F5F7FB}      % very light blue-gray

\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=black,
  urlcolor=Accent,
  citecolor=black,
  pdfauthor={Jordan Suber},
  pdftitle={OWASP API Security Top 10 (2023 Edition) — Compiled Notes},
  pdfsubject={OWASP API Security Top 10},
  pdfkeywords={OWASP, API, Security, Top 10}
}
\urlstyle{same}                 % <-- moved here (after hyperref)

% --- Structure & lists ---
\usepackage{titlesec}
\titleformat{\section}{\Large\bfseries\color{Accent}}{\thesection}{0.6em}{}
\titleformat{\subsection}{\normalsize\bfseries\color{Accent}}{\thesubsection}{0.5em}{}
\titlespacing*{\section}{0pt}{10pt plus 2pt}{6pt}
\titlespacing*{\subsection}{0pt}{6pt}{4pt}

\usepackage{enumitem}
\setlist{topsep=4pt,itemsep=2.5pt,parsep=0.5pt,leftmargin=1.25em}

% --- Callouts for readability ---
\usepackage[most]{tcolorbox}
\tcbset{
  colback=SoftBg,
  colframe=Accent!35,
  arc=2mm,
  left=8pt,right=8pt,top=6pt,bottom=6pt,
  boxrule=0.5pt,
  enhanced,
  breakable
}
\newtcolorbox{callout}[1]{title=\textbf{#1}}

% --- Header / footer ---
\usepackage{fancyhdr}
\usepackage{lastpage}
\pagestyle{fancy}
\fancyhf{}
\lhead{\footnotesize OWASP API Security Top 10 (2023)}
\rhead{\footnotesize Page \thepage\ of \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.3pt}
\renewcommand{\footrulewidth}{0pt}

% --- Title ---
\title{\vspace{-0.75em}\textbf{OWASP API Security Top 10}\\[0.25em]\large 2023 Edition — Compiled Notes}
\author{Jordan Suber}
\date{\today}

\begin{document}
\maketitle
\thispagestyle{empty}

\begin{abstract}
This document compiles the OWASP API Security Top 10 (2023) into a concise, practitioner\mbox{-}friendly reference with brief descriptions and practical controls for each risk. It is intended for architects, developers, AppSec, and platform teams building or assessing APIs.
\end{abstract}

\tableofcontents
\newpage

\section{Overview}
\begin{callout}{Project overview}
The OWASP API Security Project curates and maintains community guidance on the most critical API risks and practices to mitigate them. The 2023 edition lists ten risks that frequently surface in modern API landscapes and backends.
\end{callout}

\section{Top 10 at a Glance (2023)}
\begin{callout}{Risk list}
\begin{enumerate}
  \item \textbf{API1:2023} Broken Object Level Authorization (BOLA)
  \item \textbf{API2:2023} Broken Authentication
  \item \textbf{API3:2023} Broken Object Property Level Authorization (BOPLA)
  \item \textbf{API4:2023} Unrestricted Resource Consumption
  \item \textbf{API5:2023} Broken Function Level Authorization (BFLA)
  \item \textbf{API6:2023} Unrestricted Access to Sensitive Business Flows
  \item \textbf{API7:2023} Server\mbox{-}Side Request Forgery (SSRF)
  \item \textbf{API8:2023} Security Misconfiguration
  \item \textbf{API9:2023} Improper Inventory Management
  \item \textbf{API10:2023} Unsafe Consumption of APIs
\end{enumerate}
\end{callout}

\section{API1:2023 — Broken Object Level Authorization (BOLA)}
\begin{callout}{What it is}
Missing or weak per\mbox{-}object access checks allow attackers to manipulate object identifiers (IDs, UUIDs) to access data they do not own.
\end{callout}
\begin{callout}{Why it matters}
Direct object references are common in REST/JSON and GraphQL; BOLA often leads to high\mbox{-}impact data exposure.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Enforce object ownership/tenant checks in business logic (not only at the route layer).
  \item Use parameterized, server\mbox{-}side lookups; never trust client\mbox{-}provided ownership hints.
  \item Add centralized authorization policies (ABAC/RBAC) and test with negative cases.
\end{itemize}
\end{callout}

\section{API2:2023 — Broken Authentication}
\begin{callout}{What it is}
Flaws in credential, token, or session handling enable account takeover or identity spoofing.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Strong authentication (passkeys/WebAuthn or MFA), short\mbox{-}lived tokens, secure refresh flows.
  \item Validate JWTs (aud/iss/exp/alg), rotate keys, and pin token audience.
  \item Lockouts, device binding, and anomaly detection (IP/UA/geo velocity).
\end{itemize}
\end{callout}

\section{API3:2023 — Broken Object Property Level Authorization (BOPLA)}
\begin{callout}{What it is}
Insufficient attribute/field\mbox{-}level checks expose or allow modification of sensitive properties.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Server\mbox{-}side allowlists for readable/writable fields; enforce output filtering.
  \item Separate read vs.\ write DTOs; validate patch/merge semantics.
  \item Contract tests to prevent sensitive fields (e.g., \texttt{isAdmin}) from being exposed.
\end{itemize}
\end{callout}

\section{API4:2023 — Unrestricted Resource Consumption}
\begin{callout}{What it is}
Endpoints allow unbounded use of CPU, memory, storage, or network resources.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Rate limiting, quotas, pagination, and maximum payload limits.
  \item Timeouts, circuit breakers, and bounded concurrency.
  \item Cost\mbox{-}aware designs for expensive operations (exports, reports, search).
\end{itemize}
\end{callout}

\section{API5:2023 — Broken Function Level Authorization (BFLA)}
\begin{callout}{What it is}
Users can invoke functions/actions their role should not access (e.g., privilege escalation).
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Enforce RBAC/ABAC on every operation; avoid “hidden” admin routes.
  \item Align HTTP verbs and scope with least privilege; verify on backend, not UI.
  \item Policy\mbox{-}as\mbox{-}code + test suites for authorization matrices.
\end{itemize}
\end{callout}

\section{API6:2023 — Unrestricted Access to Sensitive Business Flows}
\begin{callout}{What it is}
Automation abuses high\mbox{-}value flows (e.g., checkout, coupon/credit, password reset) at scale.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Bot detection, rate shaping, proof\mbox{-}of\mbox{-}work or step\mbox{-}up auth on risky flows.
  \item Idempotency keys, nonce/replay protection, and transaction limits.
  \item Telemetry with alerting for anomalous volumes and sequences.
\end{itemize}
\end{callout}

\section{API7:2023 — Server-Side Request Forgery (SSRF)}
\begin{callout}{What it is}
API backend makes attacker\mbox{-}controlled outbound requests, reaching internal services/metadata.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Deny\mbox{-}by\mbox{-}default egress; strict URL/IP/hostname allowlists and DNS pinning.
  \item Block link\mbox{-}local and internal address ranges; disable HTTP redirects.
  \item Use metadata service v2/IMDSv2 and network segmentation.
\end{itemize}
\end{callout}

\section{API8:2023 — Security Misconfiguration}
\begin{callout}{What it is}
Insecure defaults or drift across gateways, runtimes, and cloud services.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Baseline hardening, CIS benchmarks, and configuration\mbox{-}as\mbox{-}code.
  \item Secure CORS, headers, TLS, error handling; remove debug endpoints.
  \item Continuous compliance checks and drift detection.
\end{itemize}
\end{callout}

\section{API9:2023 — Improper Inventory Management}
\begin{callout}{What it is}
Unknown or stale APIs/versions, missing documentation, and shadow endpoints.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Maintain authoritative API catalog (specs, versions, data classifications).
  \item Decommission legacy versions with sunset headers and routing controls.
  \item Discover shadow APIs via gateways, WAF logs, and traffic analysis.
\end{itemize}
\end{callout}

\section{API10:2023 — Unsafe Consumption of APIs}
\begin{callout}{What it is}
Trusting upstream/third\mbox{-}party APIs without validation or defense\mbox{-}in\mbox{-}depth.
\end{callout}
\begin{callout}{Key controls}
\begin{itemize}
  \item Validate and sanitize all upstream responses; schema\mbox{-}validate inputs/outputs.
  \item Constrain permissions, timeouts, retries, and fallbacks per dependency.
  \item Threat\mbox{-}model suppliers; isolate and monitor integrations.
\end{itemize}
\end{callout}

\section*{Appendix: 2019 Top 10 (for reference)}
\begin{callout}{Risk list (2019)}
\begin{enumerate}
  \item API1:2019 Broken Object Level Authorization
  \item API2:2019 Broken User Authentication
  \item API3:2019 Excessive Data Exposure
  \item API4:2019 Lack of Resources \& Rate Limiting
  \item API5:2019 Broken Function Level Authorization
  \item API6:2019 Mass Assignment
  \item API7:2019 Security Misconfiguration
  \item API8:2019 Injection
  \item API9:2019 Improper Assets Management
  \item API10:2019 Insufficient Logging \& Monitoring
\end{enumerate}
\end{callout}

\vfill
\noindent\footnotesize \textbf{License:} Portions adapted from and informed by the OWASP API Security Project (CC BY-SA 4.0).\par
\end{document}
