% dependabot-cheatsheet.tex
% CI-safe: No minted, no Pygments, no shell-escape required
\documentclass[11pt,letterpaper]{article}

% === Encoding & Fonts ===
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{microtype}

% === Page Layout ===
\usepackage[margin=1in]{geometry}
\usepackage{parskip}

% === Colors ===
\usepackage[dvipsnames]{xcolor}
\definecolor{CodeBg}{HTML}{F3F4F6}
\definecolor{Accent}{HTML}{0056B3}
\definecolor{NoteBg}{HTML}{F0F8FF}

% === Hyperlinks ===
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=black, urlcolor=blue, citecolor=black}

% === Headings ===
\usepackage{titlesec}
\titleformat{\section}{\large\bfseries\color{Accent}}{\thesection}{0.6em}{}
\titleformat{\subsection}{\bfseries}{\thesubsection}{0.5em}{}
\titlespacing*{\section}{0pt}{10pt}{5pt}
\titlespacing*{\subsection}{0pt}{8pt}{4pt}

% === Lists ===
\usepackage{enumitem}
\setlist{itemsep=2pt, topsep=4pt, leftmargin=1.2em}

% === Callout Boxes ===
\usepackage[most]{tcolorbox}
\newtcolorbox{notebox}{colback=NoteBg, colframe=Accent!60!black, sharp corners, boxrule=0.5pt}

% === Code Blocks (listings only) ===
\usepackage{listings}
\usepackage{upquote}

\lstset{
  basicstyle=\ttfamily\small,
  backgroundcolor=\color{CodeBg},
  breaklines=true,
  columns=fullflexible,
  keepspaces=true,
  showstringspaces=false,
  frame=single,
  framerule=0.4pt,
  tabsize=2,
  aboveskip=8pt,
  belowskip=8pt
}

\lstnewenvironment{yamlcode}{\lstset{language=}}{}
\lstnewenvironment{bashcode}{\lstset{language=bash}}{}

% === Silence missing .toc on first run ===
\makeatletter
\let\orig@starttoc\@starttoc
\def\@starttoc#1{\IfFileExists{\jobname.#1}{\orig@starttoc{#1}}{}}
\makeatother

% === Document ===
\title{\textbf{Dependabot Alerts \& Workflows --- Hands-On Cheatsheet}}
\author{}
\date{}

\begin{document}
\maketitle

\begin{notebox}
\textbf{Note:} This document covers Dependabot alerts, security updates, and best practices for managing dependencies in GitHub repositories.
\end{notebox}

\section{Core Concepts}

\begin{itemize}
  \item \textbf{Dependency types:} Direct dependencies are packages your code imports. \textit{Transitive} dependencies are packages required by your direct dependencies.
  \item \textbf{Where alerts appear:} Security tab, Pull Requests (as comments/checks), and via API/CLI.
  \item \textbf{Security updates:} Dependabot can automatically open PRs to bump vulnerable versions.
\end{itemize}

\section{Enable Security Updates}

Add or adjust \texttt{dependabot.yml} at repo level to scan ecosystems and open PRs automatically.

\begin{yamlcode}
version: 2
updates:
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "daily"
    open-pull-requests-limit: 5
    rebase-strategy: auto
    reviewers: ["team/security"]
    labels: ["dependencies", "security"]
\end{yamlcode}

\section{Triage Workflow}

\begin{enumerate}
  \item \textbf{Review alert severity:} Critical/High alerts should be prioritized.
  \item \textbf{Check if exploitable:} Is the vulnerable code path actually used?
  \item \textbf{Evaluate fix availability:} Is there a patched version?
  \item \textbf{Test upgrade:} Run CI/CD pipeline with the proposed changes.
  \item \textbf{Merge or dismiss:} Document the decision either way.
\end{enumerate}

\section{CLI Commands}

\begin{bashcode}
# List Dependabot alerts for a repository
gh api repos/{owner}/{repo}/dependabot/alerts

# Get specific alert details
gh api repos/{owner}/{repo}/dependabot/alerts/{alert_number}

# Dismiss an alert (with reason)
gh api repos/{owner}/{repo}/dependabot/alerts/{alert_number} \
  -X PATCH -f state=dismissed -f dismissed_reason="tolerable_risk"
\end{bashcode}

\section{Best Practices}

\begin{itemize}
  \item Enable Dependabot for all supported ecosystems in your repository.
  \item Set up branch protection rules requiring security checks to pass.
  \item Review and merge security updates promptly (within 24--48 hours for Critical).
  \item Use \texttt{@dependabot rebase} comment to update stale PRs.
  \item Configure grouped updates to reduce PR noise for related packages.
\end{itemize}

\end{document}
