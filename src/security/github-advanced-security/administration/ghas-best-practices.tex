% ghas-best-practices.tex
% CI-safe: No minted, no Pygments, no shell-escape required
\documentclass[11pt]{article}

% === Encoding & Fonts ===
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{microtype}

% === Page Layout ===
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{parskip}

% === Colors ===
\usepackage[dvipsnames]{xcolor}
\definecolor{CodeBg}{HTML}{F3F4F6}

% === Hyperlinks ===
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=MidnightBlue, urlcolor=MidnightBlue, citecolor=MidnightBlue}

% === Headings ===
\usepackage{titlesec}
\titleformat{\section}{\large\bfseries\color{MidnightBlue}}{}{0pt}{}
\titleformat{\subsection}{\normalsize\bfseries}{}{0pt}{}
\titlespacing*{\section}{0pt}{12pt}{6pt}
\titlespacing*{\subsection}{0pt}{8pt}{4pt}

% === Lists ===
\usepackage{enumitem}
\setlist{itemsep=2pt, topsep=4pt, leftmargin=1.2em}

% === Floats ===
\usepackage{float}

% === Code Blocks (listings only) ===
\usepackage{listings}
\usepackage{upquote}

\lstset{
  basicstyle=\ttfamily\footnotesize,
  backgroundcolor=\color{CodeBg},
  breaklines=true,
  columns=fullflexible,
  keepspaces=true,
  showstringspaces=false,
  frame=single,
  framerule=0.4pt,
  tabsize=2,
  aboveskip=8pt,
  belowskip=8pt
}

\lstnewenvironment{textcode}{\lstset{}}{}

% Listing float
\newfloat{codelisting}{htbp}{lol}
\floatname{codelisting}{Listing}

% === Silence missing .toc on first run ===
\makeatletter
\let\orig@starttoc\@starttoc
\def\@starttoc#1{\IfFileExists{\jobname.#1}{\orig@starttoc{#1}}{}}
\makeatother

% === Document ===
\title{\textbf{GitHub Advanced Security (GHAS) Best Practices}}
\author{}
\date{}

\begin{document}
\maketitle
\vspace{-1em}
\noindent\textit{Purpose.} Practical, auditable practices to get sustained value from GHAS across repos and teams.

\section{Speak the language of vulnerabilities}

\begin{itemize}
  \item \textbf{CVE} = specific known vulnerability; \textbf{CWE} = broader weakness class; \textbf{CVSS} informs urgency.
  \item Link GHAS alerts to CVE/CWE, read remediation notes, act by severity and exploitability.
\end{itemize}

\section{Turn on the full GHAS stack (right-sized)}

\begin{itemize}
  \item Enable and tune \textbf{Dependabot}, \textbf{Secret scanning}, and \textbf{CodeQL}.
  \item Prefer repo-specific config files over defaults to reduce noise.
\end{itemize}

\section{Close vs.\ Dismiss: decision guardrails}

\begin{itemize}
  \item \textbf{Close} when fixed and scanners rerun clean; document ``what changed'' for auditability.
  \item \textbf{Dismiss} (with reason) only for accepted risk, false positives, or unreachable code paths; review periodically.
\end{itemize}

\section{Clear roles and collaboration loop}

\begin{itemize}
  \item \textbf{Developers:} secure coding, unit tests, resolve code scanning alerts, collaborate on threat modeling.
  \item \textbf{Security:} define policy, maintain rules, run audits/pen-tests, coach developers.
\end{itemize}

\section{Cadence that matches risk}

\begin{itemize}
  \item High-risk or fast-moving apps: \textbf{weekly} reviews; lower-risk apps: \textbf{monthly}.
  \item Adapt cadence for new threats, major releases, and exposure changes.
\end{itemize}

\section{Put policy in the repo (and surface it)}

\begin{itemize}
  \item Add \texttt{SECURITY.md} (root or \texttt{.github/}) describing requirements and reporting process.
  \item Reinforce via short enablement sessions or ``lunch and learns.''
\end{itemize}

\begin{codelisting}[h]
\caption{\texttt{SECURITY.md} starter skeleton}
\begin{textcode}
# Security Policy

## Reporting a Vulnerability
Please email security@[yourorg].com with details and steps to reproduce.
Do not create public issues for suspected vulnerabilities.

## Supported Versions
- main: actively maintained
- previous: critical fixes only

## Requirements
- 2FA required for committers
- All PRs: CodeQL + secrets + dependency checks must pass

## Disclosure
We follow coordinated disclosure. We acknowledge within 48h and provide
status updates until resolution.
\end{textcode}
\end{codelisting}

\section{Make scanning policy-driven}

\begin{itemize}
  \item Align \textbf{CodeQL} queries and thresholds to written policy; keep a lean baseline and add targeted custom rules.
  \item Treat alerts as actionable work items with owners and SLAs, not informational noise.
\end{itemize}

\section{Gate merges with branch protection}

\begin{itemize}
  \item Protect \texttt{main} and other critical branches:
  \begin{itemize}
    \item Require PRs and at least one approval.
    \item Require status checks to pass: \texttt{codeql}, \texttt{dependabot}, \texttt{secret-scanning}.
    \item Dismiss stale reviews on new commits.
    \item Restrict who can push; block force-pushes and branch deletion.
  \end{itemize}
\end{itemize}

\section{Notifications that matter}

\begin{itemize}
  \item Route \textbf{critical} security events to the right responders immediately (avoid over-alerting).
\end{itemize}

\section{Stay plugged into the community}

\begin{itemize}
  \item Track advisories and research from sources like the GitHub Security Lab; fold insights into rules and runbooks.
\end{itemize}

\end{document}
