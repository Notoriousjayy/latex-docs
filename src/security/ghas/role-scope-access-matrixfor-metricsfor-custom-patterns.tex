\documentclass[11pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage{booktabs}
\usepackage{array}

\newcommand{\Yes}{\textbf{Y}}    % direct access
\newcommand{\Cond}{\textbf{C}}   % conditional access
\newcommand{\No}{--}             % no access

\begin{document}

\title{Role--Scope Access Matrix for Metrics for Custom Patterns}
\author{}
\date{}
\maketitle

\section*{Overview}

Metrics for custom patterns provide a 30--day view of alert and push--protection
activity for each custom pattern.  Access to these metrics depends on both:

\begin{itemize}
  \item The \emph{scope} at which the custom pattern was created:
        repository, organization, or enterprise.
  \item The \emph{role} of the user viewing the metrics.
\end{itemize}

\noindent
Symbols used in the matrix:
\begin{itemize}
  \item \Yes{} = Direct access by default.
  \item \Cond{} = Conditional access; requires additional admin/security
        permissions at that scope.
  \item \No{} = No access by default.
\end{itemize}

\section*{Role--Scope Access Matrix}

\begin{table}[h!]
  \centering
  \renewcommand{\arraystretch}{1.2}
  \begin{tabular}{
    >{\raggedright\arraybackslash}p{3.4cm}
    >{\raggedright\arraybackslash}p{3.1cm}
    >{\centering\arraybackslash}p{1.7cm}
    >{\centering\arraybackslash}p{1.7cm}
    >{\centering\arraybackslash}p{1.7cm}
    >{\centering\arraybackslash}p{1.9cm}
    >{\centering\arraybackslash}p{2.0cm}
  }
    \toprule
    \textbf{Scope (where pattern is defined)} &
    \textbf{Metric view} &
    \textbf{Repo owner} &
    \textbf{Repo admin} &
    \textbf{Org owner} &
    \textbf{Security manager} &
    \textbf{Enterprise admin} \\
    \midrule
    Repository level
      & Activity for a custom pattern defined in a single repository
      & \Yes  % repo owner
      & \Yes  % repo admin
      & \Cond % org owner (if has admin rights on repo)
      & \Cond % security manager (if granted repo security/admin access)
      & \Cond % enterprise admin (if granted repo admin/security access)
      \\
    Organization level
      & Aggregated activity for a custom pattern defined at org scope
      & \No   % repo owner only
      & \No   % repo admin only
      & \Yes  % org owner
      & \Yes  % org security manager
      & \Cond % enterprise admin (if given org-level permissions)
      \\
    Enterprise level
      & Aggregated activity for a custom pattern defined at enterprise scope
      & \No   % repo owner
      & \No   % repo admin
      & \No   % org owner only
      & \Cond % security manager (if assigned enterprise security role)
      & \Yes  % enterprise admin
      \\
    \bottomrule
  \end{tabular}
  \caption{Decision table for who can view metrics for custom patterns at each scope.}
\end{table}

\section*{Decision Rules}

\begin{enumerate}
  \item Any user with \emph{admin permission on a repository} (including the
        repository owner) can view metrics for repository-scoped custom
        patterns in that repository.
  \item Organization owners and designated security managers can view metrics
        for organization-scoped custom patterns for their organization.
  \item Enterprise administrators can view metrics for enterprise-scoped custom
        patterns across the enterprise.
  \item Users in roles marked \Cond{} may view metrics at that scope only if
        they have been explicitly granted admin or security permissions for the
        relevant repository, organization, or enterprise.
\end{enumerate}

\end{document}

