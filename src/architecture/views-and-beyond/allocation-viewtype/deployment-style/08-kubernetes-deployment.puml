@startuml
skinparam backgroundColor #FFFFFF
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false

skinparam node {
    BackgroundColor #E3F2FD
    BorderColor #1565C0
    FontColor #0D47A1
}

skinparam rectangle {
    BackgroundColor #FFF3E0
    BorderColor #EF6C00
    FontColor #E65100
    roundCorner 8
}

skinparam package {
    BackgroundColor #FAFAFA
    BorderColor #9E9E9E
}

title Microservices on Kubernetes

actor "External\nClients" as clients

rectangle "Ingress Controller\n(TLS termination)" as ingress

package "Namespace: production" {
    
    node "Node 1" as node1 {
        rectangle "Pod: API" as apiPod1
        rectangle "Pod: Worker" as workerPod
    }
    
    node "Node 2" as node2 {
        rectangle "Pod: API" as apiPod2
        rectangle "Pod: Auth" as authPod
    }
    
    node "Node 3" as node3 {
        rectangle "Pod: DB\n(StatefulSet)" as dbPod
    }
}

rectangle "Service:\napi-svc" as apiSvc
rectangle "Service:\nauth-svc" as authSvc
rectangle "Service:\ndb-svc" as dbSvc

database "Persistent\nVolume" as pv

clients -down-> ingress
ingress -down-> apiSvc
apiSvc --> apiPod1
apiSvc --> apiPod2
apiPod1 --> authSvc
authSvc --> authPod
apiPod1 --> dbSvc
dbSvc --> dbPod
dbPod -down-> pv

note bottom
  Allocation decisions: Pod resources (requests/limits),
  replica count, node affinity, persistent volume config
end note

@enduml
