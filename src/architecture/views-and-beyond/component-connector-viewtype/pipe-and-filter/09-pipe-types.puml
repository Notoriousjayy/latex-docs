@startuml pipe-types
title Pipe Types (Pipe-and-Filter)
left to right direction

' ----------------------------
' Untyped Pipe
' ----------------------------
rectangle "Untyped Pipe" {
  component "Producer" as UP1 <<source>>
  component "Consumer" as UC1 <<sink>>

  UP1 -right-> UC1 : data

  note bottom
    Implicit contract (no schema)
    Higher coupling via assumptions
  end note
}

' ----------------------------
' Typed Pipe
' ----------------------------
rectangle "Typed Pipe" {
  component "Producer" as TP1 <<source>>
  rectangle "Schema\\nValidation" as Schema #E1BEE7
  component "Consumer" as TC1 <<sink>>

  TP1 -right-> Schema : data
  Schema -right-> TC1 : validated

  note bottom
    Enforces data contracts
    Catches errors early
  end note
}

' ----------------------------
' Buffered Pipe
' ----------------------------
rectangle "Buffered Pipe" {
  component "Producer" as BP1 <<source>>
  rectangle "Buffer\\n(Queue)" as Buf #C8E6C9
  component "Consumer" as BC1 <<sink>>

  BP1 -right-> Buf : events
  Buf -right-> BC1 : dequeued

  note bottom
    Absorbs bursts
    Decouples producer/consumer rates
  end note
}

' ----------------------------
' Reliable Pipe
' ----------------------------
rectangle "Reliable Pipe" {
  component "Producer" as RP1 <<source>>
  rectangle "Durable\\nQueue" as DQ #BBDEFB
  component "Consumer" as RC1 <<sink>>
  rectangle "Dead-Letter\\nQueue" as DLQ #FFCDD2

  RP1 -right-> DQ : publish
  DQ -right-> RC1 : deliver
  RC1 -down-> DQ : ack
  DQ -down-> DLQ : poison msg

  note bottom
    Durability + acknowledgements
    Supports retries / DLQ handling
  end note
}

@enduml
