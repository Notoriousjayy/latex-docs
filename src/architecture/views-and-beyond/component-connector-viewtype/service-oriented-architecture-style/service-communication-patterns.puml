@startuml service-communication-patterns
!define PRIMARY #4A90A4
!define SECONDARY #E8A838

skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam sequenceMessageAlign center

skinparam participant {
    BackgroundColor PRIMARY
    FontColor white
    BorderColor #3A7084
}

skinparam sequence {
    ArrowColor #555555
    ArrowFontColor #555555
    ArrowFontSize 10
    LifeLineBorderColor #888888
    LifeLineBackgroundColor #F5F5F5
    GroupBackgroundColor #FAFAFA
    GroupBorderColor #CCCCCC
    DividerBackgroundColor #F0F0F0
}

title Service Communication Patterns

participant "Consumer" as consumer
participant "Provider" as provider
participant "Message\nBroker" as broker

== Synchronous (Request-Response) ==

consumer -> provider : 1. Send Request
activate provider
provider --> consumer : 2. Process & Return Response
deactivate provider

note right of provider
  Consumer **waits**
  for response
  
  Simple to reason about
  but creates temporal
  coupling
end note

== Asynchronous (Message-Based) ==

consumer -> broker : 1. Publish Message
activate broker
broker --> consumer : 2. Acknowledge
deactivate broker
note right of consumer : Consumer continues\nwithout waiting

broker -> provider : 3. Deliver Message
activate provider
provider --> broker : 4. Process Complete
deactivate provider

alt Callback Pattern
    provider -> consumer : 5. Send Result (callback)
else Polling Pattern
    consumer -> broker : 5. Check for Result
    broker --> consumer : 6. Return Result
end

note right of provider
  Consumer and provider
  **decoupled** in time
  
  Better resilience but
  more complex handling
end note

@enduml
