@startuml 08-security-threats

skinparam backgroundColor #FFFFFF
skinparam defaultFontName "Helvetica"
skinparam defaultFontSize 12
skinparam shadowing false
skinparam RoundCorner 10
skinparam padding 4

title <b>P2P Security Threats: Sybil & Eclipse Attacks</b>\nTwo fundamental attacks exploiting decentralized identity and connectivity

skinparam rectangle {
  BackgroundColor<<honest>> #10B981
  FontColor<<honest>> #FFFFFF
  BorderColor<<honest>> #059669
  BackgroundColor<<malicious>> #EF4444
  FontColor<<malicious>> #FFFFFF
  BorderColor<<malicious>> #DC2626
  BackgroundColor<<victim>> #F59E0B
  FontColor<<victim>> #FFFFFF
  BorderColor<<victim>> #D97706
}

skinparam package {
  BackgroundColor #F8FAFC
  BorderColor #CBD5E1
  FontStyle bold
}

package "Sybil Attack" as SA {
  rectangle "  Honest A  " as sa_h1 <<honest>>
  rectangle "  Honest B  " as sa_h2 <<honest>>
  rectangle "  Fake ID 1  " as sa_f1 <<malicious>>
  rectangle "  Fake ID 2  " as sa_f2 <<malicious>>
  rectangle "  Fake ID 3  " as sa_f3 <<malicious>>
  rectangle "  Fake ID 4  " as sa_f4 <<malicious>>

  sa_h1 -[#94A3B8]- sa_h2
  sa_h1 -[#EF4444]- sa_f1
  sa_h2 -[#EF4444]- sa_f2
  sa_f1 -[#EF4444,dashed]- sa_f3
  sa_f2 -[#EF4444,dashed]- sa_f4
  sa_f3 -[#EF4444,dashed]- sa_f4

  note bottom of SA
    One attacker creates many fake
    identities to gain disproportionate
    influence over the network.
  end note
}

package "Eclipse Attack" as EA {
  rectangle "  Honest C  " as ea_h1 <<honest>>
  rectangle "  Honest D  " as ea_h2 <<honest>>
  rectangle " **Victim** " as ea_v <<victim>>
  rectangle "  Attacker 1  " as ea_a1 <<malicious>>
  rectangle "  Attacker 2  " as ea_a2 <<malicious>>
  rectangle "  Attacker 3  " as ea_a3 <<malicious>>

  ea_h1 -[#10B981]- ea_h2

  ea_a1 -[#EF4444,bold]- ea_v
  ea_a2 -[#EF4444,bold]- ea_v
  ea_a3 -[#EF4444,bold]- ea_v

  ea_h1 -[#94A3B8,dashed]- ea_a1 : blocked

  note bottom of EA
    Attacker controls all connections
    to a victim, isolating it from the
    honest network entirely.
  end note
}

legend right
  |<#10B981> <color:#FFFFFF>  Honest  </color>| Legitimate participant |
  |<#EF4444> <color:#FFFFFF>  Malicious  </color>| Attacker-controlled |
  |<#F59E0B> <color:#FFFFFF>  Victim  </color>| Targeted peer |
end legend
@enduml
