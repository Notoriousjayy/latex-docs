@startuml
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam shadowing false
skinparam roundCorner 5

skinparam rectangle {
    BorderColor #424242
}

skinparam package {
    BackgroundColor #FAFAFA
    BorderColor #BDBDBD
}

title Common Client-Server Patterns

package "API Gateway Pattern" {
    rectangle "Web Client" as WC1 #E3F2FD
    rectangle "Mobile Client" as MC1 #E3F2FD
    rectangle "API Gateway" as GW #FFF3E0
    rectangle "Service A" as SA1 #E8F5E9
    rectangle "Service B" as SB1 #E8F5E9
    rectangle "Service C" as SC1 #E8F5E9
    
    WC1 --> GW
    MC1 --> GW
    GW --> SA1
    GW --> SB1
    GW --> SC1
}
note bottom of GW : Single entry point\nAuth, routing, rate limiting

package "Backend for Frontend (BFF)" {
    rectangle "Web App" as WC2 #E3F2FD
    rectangle "Mobile App" as MC2 #E3F2FD
    rectangle "Web BFF" as WBFF #F3E5F5
    rectangle "Mobile BFF" as MBFF #F3E5F5
    rectangle "Core Services" as CORE #E8F5E9
    
    WC2 --> WBFF
    MC2 --> MBFF
    WBFF --> CORE
    MBFF --> CORE
}
note bottom of WBFF : Dedicated backends\nfor each client type

package "Service Mesh" {
    rectangle "Service X" as SX #E8F5E9
    rectangle "Proxy X" as PX #FCE4EC
    rectangle "Service Y" as SY #E8F5E9
    rectangle "Proxy Y" as PY #FCE4EC
    rectangle "Control Plane" as CP #FFF3E0
    
    SX - PX
    SY - PY
    PX <--> PY : mTLS
    CP ..> PX : config
    CP ..> PY : config
}
note bottom of CP : Sidecar proxies\nhandle communication

legend right
  |= Component |= Color |
  | Client | <#E3F2FD> |
  | Gateway | <#FFF3E0> |
  | Service | <#E8F5E9> |
  | BFF | <#F3E5F5> |
  | Mesh/Proxy | <#FCE4EC> |
endlegend
@enduml
