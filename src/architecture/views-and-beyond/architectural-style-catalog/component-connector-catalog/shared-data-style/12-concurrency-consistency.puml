@startuml
skinparam backgroundColor #FEFEFE
skinparam defaultFontSize 11
skinparam defaultFontName Arial
skinparam shadowing false

skinparam rectangle {
    BorderColor #455A64
}

title Concurrency Control & Consistency Models\nManaging concurrent access to shared data

rectangle "Concurrency Control Strategies" as concurrency {
    rectangle "Pessimistic Locking" as pessimistic #FFCDD2 {
        rectangle "Lock before access" as lock1 #FFEBEE
        rectangle "Block conflicting ops" as lock2 #FFEBEE
        rectangle "Deadlock possible" as lock3 #FFEBEE
    }
    
    rectangle "Optimistic Locking" as optimistic #C8E6C9 {
        rectangle "Allow concurrent access" as opt1 #E8F5E9
        rectangle "Detect conflicts at commit" as opt2 #E8F5E9
        rectangle "Retry on conflict" as opt3 #E8F5E9
    }
    
    rectangle "MVCC" as mvcc #BBDEFB {
        rectangle "Multiple versions" as mv1 #E3F2FD
        rectangle "Snapshot isolation" as mv2 #E3F2FD
        rectangle "No read blocking" as mv3 #E3F2FD
    }
}

rectangle "Consistency Models" as consistency {
    rectangle "Strong Consistency" as strong #E8F5E9
    rectangle "Eventual Consistency" as eventual #FFF3E0
    rectangle "Causal Consistency" as causal #E3F2FD
}

rectangle "CAP Theorem Trade-offs" as cap #F3E5F5 {
    rectangle "CP (Consistent + Partition-tolerant)" as cp #E1BEE7
    rectangle "AP (Available + Partition-tolerant)" as ap #E1BEE7
}

note bottom of strong
  Reads see latest write
  Higher latency
end note

note bottom of eventual
  Temporary inconsistency
  Higher availability
end note

note bottom of causal
  Preserves cause-effect
  Balanced approach
end note

note bottom of cap
  During network partition:
  CP: Sacrifice availability
  AP: Sacrifice consistency
end note

legend bottom
  Choose concurrency control and consistency model
  based on application requirements and trade-offs
endlegend

@enduml
