@startuml
skinparam backgroundColor #FEFEFE
skinparam defaultFontSize 11
skinparam defaultFontName Arial
skinparam shadowing false

skinparam component {
    BorderColor #455A64
}

skinparam queue {
    BackgroundColor #FFF3E0
    BorderColor #E65100
}

title Event Sourcing with Shared Log\nImmutable event stream as source of truth

[Order\nService] as orderSvc #E8F5E9
[Inventory\nService] as invSvc #E8F5E9
[Notification\nService] as notifSvc #E8F5E9

rectangle "Event Log (Immutable)" as eventLog #FFF3E0 {
    queue "Event 1:\nOrderCreated" as e1 #FFE0B2
    queue "Event 2:\nPaymentReceived" as e2 #FFE0B2
    queue "Event 3:\nItemShipped" as e3 #FFE0B2
    queue "Event N:\n..." as en #FFE0B2
}

database "Orders\nProjection" as ordersView #E3F2FD
database "Inventory\nProjection" as invView #E3F2FD
database "Analytics\nProjection" as analyticsView #E3F2FD

orderSvc --> eventLog : Append events
invSvc --> eventLog : Append events
notifSvc --> eventLog : Subscribe

eventLog --> ordersView : Project
eventLog --> invView : Project
eventLog --> analyticsView : Project

note bottom of eventLog
  Immutable Event Store
  Append-only operations
  Complete audit trail
  Replay capability
end note

note right of ordersView
  Derived State
  Each projection builds
  its own view by
  replaying relevant events
end note

legend bottom
  Events are the source of truth;
  current state is derived by replaying event history
endlegend

@enduml
