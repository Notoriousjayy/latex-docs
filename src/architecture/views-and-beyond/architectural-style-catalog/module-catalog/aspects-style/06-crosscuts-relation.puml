@startuml

skinparam backgroundColor #FEFEFE
skinparam defaultFontName Helvetica
skinparam defaultFontSize 12
skinparam shadowing false
skinparam roundcorner 8
skinparam classBackgroundColor #FFFFFF
skinparam classBorderColor #475569
skinparam classFontColor #1E293B
skinparam classHeaderBackgroundColor #E2E8F0

title The Crosscuts Relation (Many-to-Many)

together {
  class "<<aspect>>\nLogging" as log #FDE68A {
    pointcut: execution(* svc.*.*(..))
    advice: before, afterReturning
  }

  class "<<aspect>>\nSecurity" as sec #FECACA {
    pointcut: @Secured methods
    advice: before (authz check)
  }

  class "<<aspect>>\nTransaction" as tx #D1FAE5 {
    pointcut: @Transactional methods
    advice: around (begin/commit/rollback)
  }

  class "<<aspect>>\nCaching" as cache #E9D5FF {
    pointcut: @Cacheable methods
    advice: around (cache lookup)
  }
}

together {
  class "OrderService" as os #DBEAFE {
    + createOrder()  @Secured @Tx
    + getOrder()     @Cacheable
  }

  class "PaymentService" as pay #DBEAFE {
    + processPayment()  @Secured @Tx
    + getBalance()      @Cacheable
  }

  class "InventoryService" as inv #DBEAFE {
    + updateStock()   @Tx
    + checkStock()    @Cacheable
  }
}

log ..[#B45309]..> os : <<crosscuts>>
log ..[#B45309]..> pay : <<crosscuts>>
log ..[#B45309]..> inv : <<crosscuts>>

sec ..[#DC2626]..> os : <<crosscuts>>
sec ..[#DC2626]..> pay : <<crosscuts>>

tx ..[#16A34A]..> os : <<crosscuts>>
tx ..[#16A34A]..> pay : <<crosscuts>>
tx ..[#16A34A]..> inv : <<crosscuts>>

cache ..[#7C3AED]..> os : <<crosscuts>>
cache ..[#7C3AED]..> pay : <<crosscuts>>
cache ..[#7C3AED]..> inv : <<crosscuts>>

note as N1
  One aspect crosscuts many modules.
  One module is crosscut by many aspects.
  Pointcuts define **which join points** are affected.
end note

@enduml
