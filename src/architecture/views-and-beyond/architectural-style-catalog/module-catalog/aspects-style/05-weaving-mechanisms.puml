@startuml

skinparam backgroundColor #FEFEFE
skinparam defaultFontName Helvetica
skinparam defaultFontSize 12
skinparam shadowing false
skinparam roundcorner 8
skinparam rectangleFontColor #1E293B
skinparam rectangleBorderColor #94A3B8

title Aspect Weaving Mechanisms

rectangle "**Compile-Time Weaving**" as ctw #F0F4F8 {
  rectangle "Source Code\n+ Aspects" as ct_in #DBEAFE
  rectangle "Aspect\nCompiler\n(e.g. ajc)" as ct_comp #FFFFFF
  rectangle "Woven\nBytecode" as ct_out #D1FAE5

  ct_in -right-> ct_comp
  ct_comp -right-> ct_out
}

rectangle "**Load-Time Weaving**" as ltw #F0F4F8 {
  rectangle "Compiled\nBytecode" as lt_in #DBEAFE
  rectangle "Class Loader\nAgent" as lt_comp #FFFFFF
  rectangle "Woven\nClasses" as lt_out #D1FAE5

  lt_in -right-> lt_comp
  lt_comp -right-> lt_out
}

rectangle "**Runtime Weaving**" as rtw #F0F4F8 {
  rectangle "Running\nObjects" as rt_in #DBEAFE
  rectangle "Proxy\nFactory" as rt_comp #FFFFFF
  rectangle "Dynamic\nProxies" as rt_out #D1FAE5

  rt_in -right-> rt_comp
  rt_comp -right-> rt_out
}

ctw -[hidden]down-> ltw
ltw -[hidden]down-> rtw

note right of ctw
  Full optimization.
  Requires aspect-aware build.
  e.g. AspectJ compiler
end note

note right of ltw
  No recompilation needed.
  JVM agent intercepts loading.
  e.g. AspectJ LTW
end note

note right of rtw
  Maximum flexibility.
  Higher runtime overhead.
  e.g. Spring AOP, JDK proxies
end note

@enduml
