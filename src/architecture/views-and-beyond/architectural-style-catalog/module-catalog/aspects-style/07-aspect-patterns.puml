@startuml

skinparam backgroundColor #FEFEFE
skinparam defaultFontName Helvetica
skinparam defaultFontSize 11
skinparam shadowing false
skinparam roundcorner 8
skinparam rectangleFontColor #1E293B
skinparam rectangleBorderColor #94A3B8

title Common Aspect Patterns

rectangle "**Tracing**" as trace #FDE68A {
  rectangle "before: log entry + args\nafter: log result or exception" as trace_d #FFF8E1
}

rectangle "**Security**" as secpat #FECACA {
  rectangle "before: check authn / authz\naround: suppress if unauthorized" as sec_d #FFF5F5
}

rectangle "**Transaction**" as txpat #D1FAE5 {
  rectangle "around: begin tx, proceed,\ncommit on success / rollback on fail" as tx_d #ECFDF5
}

rectangle "**Caching**" as cachepat #E9D5FF {
  rectangle "around: check cache, return if hit\nproceed and store if miss" as cache_d #F5F3FF
}

rectangle "**Retry**" as retrypat #FED7AA {
  rectangle "around: catch transient failures\nretry with backoff until limit" as retry_d #FFF7ED
}

rectangle "**Validation**" as valpat #BFDBFE {
  rectangle "before: validate preconditions\nafter: validate postconditions" as val_d #EFF6FF
}

trace -[hidden]right-> secpat
secpat -[hidden]right-> txpat
cachepat -[hidden]right-> retrypat
retrypat -[hidden]right-> valpat
trace -[hidden]down-> cachepat

note as legend
  Each pattern encapsulates a common crosscutting
  concern using specific **advice types**.
end note

@enduml
