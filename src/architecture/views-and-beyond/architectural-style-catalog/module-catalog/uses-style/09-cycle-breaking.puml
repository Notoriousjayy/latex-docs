@startuml

skinparam backgroundColor white
skinparam defaultFontSize 12
skinparam ArrowColor #2C3E50
skinparam ArrowThickness 2
skinparam RectangleBorderColor #2C3E50
skinparam RectangleFontSize 13
skinparam PackageBorderColor #566573
skinparam PackageBackgroundColor #FAFAFA

title Breaking a Uses Cycle via Dependency Inversion

package "BEFORE: Cyclic Dependency" as BEFORE #FFEBEE {
  rectangle "User Interface\n(Module A)" as A1 #FFCDD2
  rectangle "Business Logic\n(Module B)" as B1 #FFCDD2

  A1 -right-> B1 : <<uses>>\noperations
  B1 -left-> A1 : <<uses>>\nnotifications
}

note bottom of BEFORE
  **Problem:** Neither A nor B
  can be developed, tested,
  or deployed independently
end note

package "AFTER: Cycle Broken" as AFTER #E8F5E9 {
  rectangle "User Interface\n(Module A)" as A2 #C8E6C9
  rectangle "<<interface>>\nNotificationListener" as IF #FFF9C4
  rectangle "Business Logic\n(Module B)" as B2 #C8E6C9

  A2 -right-> B2 : <<uses>>\noperations
  B2 -down-> IF : <<uses>>\nnotifies via interface
  A2 .down.> IF : <<implements>>
}

note bottom of AFTER
  **Solution:** B defines an interface;
  A implements it. B depends on
  the interface, not on A directly.
  No cycle remains.
end note
@enduml
