@startuml 07-ecommerce-data-model
!define CORE_BG #E8F0FE
!define CORE_BD #4A90D9
!define REF_BG #EDE8F5
!define REF_BD #7B68AE
!define TRANS_BG #E8F5E8
!define TRANS_BD #5BA85B
!define ASSOC_BG #FDE8D8
!define ASSOC_BD #D4763C

skinparam backgroundColor white
skinparam defaultFontName "Helvetica"
skinparam defaultFontSize 11
skinparam shadowing false
skinparam roundCorner 4

skinparam class {
  FontSize 12
  AttributeFontSize 10
}

title <size:18><b>E-Commerce Data Model</b></size>\n<size:12>Core entities, relationships, and reference data</size>

class "Customer" as cust <<Core>> #E8F0FE {
  customer_id : UUID <<PK>>
  email : String <<UK>>
  first_name : String
  last_name : String
  phone : String
  created_at : DateTime
}

class "Order" as ord <<Transaction>> #E8F5E8 {
  order_id : UUID <<PK>>
  customer_id : UUID <<FK>>
  order_date : DateTime
  status : Enum
  shipping_method_id : UUID <<FK>>
  total_amount : Decimal
}

class "OrderLine" as ol <<Association>> #FDE8D8 {
  order_id : UUID <<FK,PK>>
  product_id : UUID <<FK,PK>>
  quantity : Integer
  unit_price : Decimal
  line_total : Decimal
}

class "Product" as prod <<Core>> #E8F0FE {
  product_id : UUID <<PK>>
  sku : String <<UK>>
  name : String
  description : Text
  price : Decimal
  stock_qty : Integer
  category_id : UUID <<FK>>
}

class "Category" as cat <<Reference>> #EDE8F5 {
  category_id : UUID <<PK>>
  parent_id : UUID <<FK>>
  name : String
  level : Integer
}

class "Payment" as pay <<Transaction>> #E8F5E8 {
  payment_id : UUID <<PK>>
  order_id : UUID <<FK>>
  method_id : UUID <<FK>>
  amount : Decimal
  status : Enum
  paid_at : DateTime
}

class "PaymentMethod" as pm <<Reference>> #EDE8F5 {
  method_id : UUID <<PK>>
  type : Enum
  display_name : String
}

class "ShippingMethod" as sm <<Reference>> #EDE8F5 {
  shipping_method_id : UUID <<PK>>
  name : String
  cost : Decimal
  est_days : Integer
}

cust "1" -- "0..*" ord : places >
ord "1" *-- "1..*" ol : contains >
ol "0..*" -- "1" prod : references >
prod "0..*" -- "1" cat : classified by >
cat "0..*" -- "0..1" cat : parent >
ord "1" -- "0..*" pay : paid by >
pay "0..*" -- "1" pm : uses >
ord "0..*" -- "1" sm : shipped via >

legend bottom left
  |= Color |= Entity Type |
  | <#E8F0FE> | Core Entity |
  | <#E8F5E8> | Transaction Entity |
  | <#FDE8D8> | Association Entity |
  | <#EDE8F5> | Reference Entity |
end legend

@enduml
