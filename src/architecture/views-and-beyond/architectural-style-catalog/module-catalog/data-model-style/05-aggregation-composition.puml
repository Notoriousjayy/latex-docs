@startuml 05-aggregation-composition
!define ACCENT #4A90D9
!define LIGHT #E8F0FE
!define GREEN #5BA85B
!define LIGHT_GREEN #E8F5E8
!define BORDER #3A3A3A

skinparam backgroundColor white
skinparam defaultFontName "Helvetica"
skinparam defaultFontSize 11
skinparam shadowing false
skinparam roundCorner 4

skinparam class {
  BackgroundColor LIGHT
  BorderColor ACCENT
  FontSize 12
  AttributeFontSize 10
  HeaderBackgroundColor ACCENT
  HeaderFontColor white
}

title <size:18><b>Aggregation & Composition</b></size>\n<size:12>Whole-part relationships with lifecycle dependencies</size>

class "Order" as order {
  order_id : UUID <<PK>>
  customer_id : UUID <<FK>>
  order_date : Date
  status : Enum
  total_amount : Decimal
}

class "OrderLine" as line {
  line_id : UUID <<PK>>
  order_id : UUID <<FK>>
  product_id : UUID <<FK>>
  quantity : Integer
  unit_price : Decimal
  line_total : Decimal
}

class "ShippingAddress" as addr {
  address_id : UUID <<PK>>
  order_id : UUID <<FK>>
  street : String
  city : String
  postal_code : String
}

order *-- "1..*" line : "composition\n(lifecycle-dependent)"
order *-- "1" addr : "composition\n(lifecycle-dependent)"

note right of order
  **Aggregate Root**
  Controls lifecycle of its parts.
  Deletion cascades to all children.
  Consistency boundary for transactions.
end note

note bottom of line
  Cannot exist without
  parent Order
end note

legend bottom
  |= Symbol |= Meaning |
  | ◆── | **Composition**: parts destroyed with whole |
  | ◇── | **Aggregation**: parts may survive independently |
end legend

@enduml
