@startuml 05-constraints
skinparam backgroundColor #FFFFFF
skinparam defaultFontName "Helvetica"
skinparam defaultFontSize 11
skinparam padding 6
skinparam roundCorner 6

title Decomposition Constraints: Valid Tree Structure

skinparam rectangle {
  FontSize 11
}

together {
  rectangle "**Valid Decomposition (Tree)**" as valid_title #FFFFFF

  rectangle "System" as v_root #E8EAF6 {
    rectangle "Module A" as v_a #C5CAE9 {
      rectangle "A.1" as v_a1 #BBDEFB
      rectangle "A.2" as v_a2 #BBDEFB
    }
    rectangle "Module B" as v_b #C5CAE9 {
      rectangle "B.1" as v_b1 #BBDEFB
      rectangle "B.2" as v_b2 #BBDEFB
    }
  }

  note bottom of v_root
    **Constraints satisfied:**
    ✓ Acyclic (tree structure)
    ✓ Single parent per module
    ✓ Complete containment
    ✓ Leaf modules implemented directly
  end note
}

together {
  rectangle "**Invalid: Shared Module**" as invalid1_title #FFFFFF

  rectangle "System" as i1_root #FBE9E7 {
    rectangle "Module X" as i1_x #FFCCBC {
      rectangle "Shared?" as i1_s #EF9A9A
    }
    rectangle "Module Y" as i1_y #FFCCBC {
    }
  }

  i1_y -[#E53935,dashed]-> i1_s : <color:#E53935>violates\nsingle parent</color>

  note bottom of i1_root
    **Constraint violated:**
    ✗ Module cannot belong to
      two parents. Use utility
      module or dependency instead.
  end note
}

valid_title -[hidden]right-> invalid1_title

@enduml
