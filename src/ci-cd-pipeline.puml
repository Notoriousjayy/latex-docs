@startuml ci-cd-pipeline
title CI/CD Pipeline Sequence

actor Developer
participant "GitHub" as GH
participant "Actions Runner" as Runner
participant "Build Stage" as Build
participant "Test Stage" as Test
participant "Security Scan" as Security
participant "Container Registry" as Registry
participant "Deployment" as Deploy

Developer -> GH: Push to main branch
activate GH

GH -> Runner: Trigger workflow
activate Runner

Runner -> Build: Checkout & compile
activate Build
Build --> Runner: Build artifacts
deactivate Build

Runner -> Test: Run test suites
activate Test
Test --> Runner: Test results
deactivate Test

Runner -> Security: SAST / Dependency scan
activate Security
Security --> Runner: Security report
deactivate Security

alt All checks pass
  Runner -> Registry: Push container image
  activate Registry
  Registry --> Runner: Image digest
  deactivate Registry
  
  Runner -> Deploy: Deploy to environment
  activate Deploy
  Deploy --> Runner: Deployment status
  deactivate Deploy
  
  Runner --> GH: Workflow success
else Checks failed
  Runner --> GH: Workflow failed
end

GH --> Developer: Status notification
deactivate Runner
deactivate GH

@enduml
